<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MigraciÃ³n al Sistema de Lotes - SIMETRIC GYM</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            line-height: 1.6;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        h1 {
            color: #880808;
            text-align: center;
            border-bottom: 3px solid #880808;
            padding-bottom: 15px;
        }
        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        .step {
            background: #f8f9fa;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #880808;
            border-radius: 5px;
        }
        .step h3 {
            color: #880808;
            margin-top: 0;
        }
        .command-box {
            background: #1a1a1a;
            color: #f2f3d9;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            margin: 10px 0;
            overflow-x: auto;
        }
        .problem {
            background: #ffebee;
            border-left: 4px solid #f44336;
            padding: 15px;
            margin: 15px 0;
        }
        .solution {
            background: #e8f5e8;
            border-left: 4px solid #4caf50;
            padding: 15px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ MigraciÃ³n al Sistema de Lotes</h1>
        
        <div class="error">
            <strong>âŒ Problemas Detectados:</strong>
            <ul>
                <li>La tabla <code>movimientos_stock</code> no tiene la columna <code>lote_id</code></li>
                <li>Los productos registrados no crean lotes automÃ¡ticamente</li>
                <li>El stock aparece en 0 porque se calcula desde lotes inexistentes</li>
            </ul>
        </div>

        <div class="solution">
            <strong>âœ… SoluciÃ³n:</strong> Ejecutar script de migraciÃ³n para actualizar la estructura de la base de datos y migrar productos existentes al sistema de lotes.
        </div>

        <div class="step">
            <h3>ğŸš€ Paso 1: Ejecutar MigraciÃ³n</h3>
            <p>Ejecuta el siguiente comando para migrar la base de datos:</p>
            <div class="command-box">
node migracion-lotes.js
            </div>
            <p><strong>Este script harÃ¡:</strong></p>
            <ul>
                <li>âœ… Crear la tabla <code>lotes</code> si no existe</li>
                <li>âœ… Actualizar <code>movimientos_stock</code> con columna <code>lote_id</code></li>
                <li>âœ… Migrar productos existentes con stock > 0 a lotes</li>
                <li>âœ… Crear movimientos de stock para la migraciÃ³n</li>
            </ul>
        </div>

        <div class="step">
            <h3>ğŸ“Š Paso 2: Verificar MigraciÃ³n</h3>
            <p>DespuÃ©s de ejecutar el script, verifica que:</p>
            <ul>
                <li>ğŸ” Los productos muestren el stock correcto</li>
                <li>ğŸ” Se puedan registrar nuevas compras sin errores</li>
                <li>ğŸ” El historial de lotes funcione correctamente</li>
                <li>ğŸ” Los nuevos productos creen lotes automÃ¡ticamente</li>
            </ul>
        </div>

        <div class="step">
            <h3>ğŸ†• Cambios en el Registro de Productos</h3>
            <p>El mÃ³dulo de registro ahora:</p>
            <ul>
                <li>âœ… Crea automÃ¡ticamente un lote inicial si el stock > 0</li>
                <li>âœ… Registra el movimiento de stock correspondiente</li>
                <li>âœ… Usa transacciones para garantizar consistencia</li>
                <li>âœ… Muestra informaciÃ³n del lote creado</li>
            </ul>
        </div>

        <div class="warning">
            <strong>âš ï¸ Importante:</strong>
            <ul>
                <li>Haz un respaldo de la base de datos antes de ejecutar la migraciÃ³n</li>
                <li>La migraciÃ³n es automÃ¡tica y segura, pero siempre es bueno tener respaldo</li>
                <li>Los productos existentes se migrarÃ¡n con un lote inicial</li>
                <li>El proveedor de productos migrados serÃ¡ "MigraciÃ³n automÃ¡tica"</li>
            </ul>
        </div>

        <div class="step">
            <h3>ğŸ”„ Flujo DespuÃ©s de la MigraciÃ³n</h3>
            
            <h4>ğŸ“¦ Registro de Productos:</h4>
            <ol>
                <li>Se crea el producto en la tabla <code>productos</code></li>
                <li>Si tiene stock inicial > 0, se crea un lote en <code>lotes</code></li>
                <li>Se registra el movimiento en <code>movimientos_stock</code></li>
                <li>El stock se calcula desde los lotes activos</li>
            </ol>

            <h4>ğŸ›’ Nueva Compra:</h4>
            <ol>
                <li>Se crea un nuevo lote independiente</li>
                <li>Se registra el movimiento de entrada</li>
                <li>El stock total se actualiza automÃ¡ticamente</li>
                <li>Se mantiene la trazabilidad por lote</li>
            </ol>
        </div>

        <div class="success">
            <strong>ğŸ‰ Beneficios del Sistema de Lotes:</strong>
            <ul>
                <li>ğŸ¯ Control preciso de costos por lote</li>
                <li>ğŸ“Š Trazabilidad completa de productos</li>
                <li>ğŸ’° CÃ¡lculo exacto de rentabilidad</li>
                <li>ğŸ”„ Preparado para lÃ³gica PEPS en ventas</li>
                <li>ğŸ“ˆ Historial detallado de movimientos</li>
            </ul>
        </div>

        <div class="step">
            <h3>ğŸ§ª Pruebas Recomendadas</h3>
            <p>DespuÃ©s de la migraciÃ³n, prueba:</p>
            <ol>
                <li>âœ… Registrar un producto nuevo con stock inicial</li>
                <li>âœ… Realizar una nueva compra de un producto existente</li>
                <li>âœ… Ver el historial de lotes en gestiÃ³n de inventario</li>
                <li>âœ… Verificar que el stock se calcule correctamente</li>
            </ol>
        </div>
    </div>
</body>
</html>
